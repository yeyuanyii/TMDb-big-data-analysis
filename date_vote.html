<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,height=device-height">
  <title>散点图</title>
  <style>
    ::-webkit-scrollbar {
      display: none;
    }

    html,
    body {
      overflow: hidden;
      width: 100%;
      margin: 0;
    }
  </style>
</head>

<body>
  <div id="mountNode"></div>
  <script>/* 修复 Safari 中 iframe window.innerHeight 为 0 的问题 */ document.body.clientHeight;</script>
  <script src="./static/g2.min.js"></script>
  <script src="./static/data-set.min.js"></script>
  <script src="./static/jquery-3.2.1.min.js"></script>
  <script>
    $.getJSON('./static/date_vote.json', function (data) {
      data = data.map(v => ({
        title: v[2],
        date: new Date(v[0]),
        score: parseFloat(v[1])
      }))
      var chart = new G2.Chart({
        container: 'mountNode',
        width: 1300, // 设置宽度为 1300
        height: 555, // 设置高度为 555
        padding: [40, 80, 80, 80],
      });
      chart.scale("date", {
        alias: "发布日期"
      });
      chart.axis("score", {
        title: {
          text: '评分'
        },
        label: {
          textStyle: {
            fill: 'rgb(117, 117, 117)'
          }
        }
      });
      chart.axis("date", {
        title: {
          text: '发布日期'
        },
        label: {
          textStyle: {
            fill: 'rgb(117, 117, 117)'
          }
        }
      });
      chart.source(data, {
        'date': {
          type: 'time',
          mask: 'YYYY-MM-DD'
        }
      });
      chart.tooltip({
        showTitle: false,
        crosshairs: {
          type: 'cross'
        },
        itemTpl: '<li data-index={index} style="margin-bottom:4px;">' + '<span style="background-color:{color};" class="g2-tooltip-marker"></span>' + '{name}<br/>' + '{value}' + '</li>'
      });
      chart.point().position('date*score').size(4).shape('circle').color("#48c96f").opacity(0.65).tooltip('title*date*score', function (title, date, score) {
        return {
          name: title,
          value: date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate() + ' 上映 ,  ' + ' 平均评分: ' + score
        };
      });
      chart.render();
    });
  </script>
</body>

</html>